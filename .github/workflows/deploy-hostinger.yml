name: Deploy to Hostinger (FTP)

on:
  workflow_dispatch:
  push:
    branches: [ main, master ]

permissions:
  contents: read

jobs:
  deploy:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout
        uses: actions/checkout@v4

      - name: Check for required secrets
        id: check-secrets
        run: |
          if [ -z "${{ secrets.FTP_SERVER }}" ] || [ -z "${{ secrets.FTP_USERNAME }}" ] || [ -z "${{ secrets.FTP_PASSWORD }}" ]; then
            echo "::error::Missing required FTP secrets. Please configure FTP_SERVER, FTP_USERNAME, and FTP_PASSWORD in GitHub Settings → Secrets and variables → Actions"
            exit 1
          fi
          echo "Secrets configured. Proceeding with deployment..."

      - name: Deploy via FTP
        uses: SamKirkland/FTP-Deploy-Action@v4.3.4
        with:
          server: ${{ secrets.FTP_SERVER }}
          username: ${{ secrets.FTP_USERNAME }}
          password: ${{ secrets.FTP_PASSWORD }}
          port: ${{ secrets.FTP_PORT || 21 }}
          protocol: ${{ secrets.FTP_PROTOCOL || 'ftp' }}
          local-dir: ./
          server-dir: ${{ secrets.FTP_DIR || '/public_html/' }}
          exclude: |
            **/.git*
            **/.github/**
            **/node_modules/**
            **/.vscode/**
            **/*.map
            **/src/**
            **/README*.md
            **/ARCHITECTURE_*.md
            **/*.ps1
            **/*.sh
            **/*.bat
            **/package*.json
            **/vite.config.js
            **/.editorconfig
            **/.DS_Store
